<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>í™”ì‚´í‘œ í•¨ìˆ˜ë¥¼ í™œìš©í•œ ìˆ«ì ì¦ê°€_ê°ì†Œ</title>
  <!-- tailwind css cdn ì£¼ì†Œ ì—°ê²°í•˜ê¸° -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.0.1/dist/tailwind.min.css" type="text/css">
  <script src="http://cdn.tailwindcss.com"></script>
</head>

<body>
  <h2 class="font-bold text-xl">í™”ì‚´í‘œ í•¨ìˆ˜ë¥¼ í™œìš©í•œ ìˆ«ì ì¦ê°€_ê°ì†Œ</h2>
  <div class="bg-gray-100">
    <div class="min-h-screen flex items-center justify-center p-6">

      <div class="w-full max-w-2xl bg-white border border-gray-200 rounded-md shadow-sm p-6 space-y-4">
        <div class="flex items-start gap-4 ">
          <label for="product" class="text-sm text-gray-500 shrink-0 w-20 pt-2">êµ¬ë§¤ ìˆ˜ëŸ‰</label>
          <div class="w-full flex-1 space-y-3 ml-7">
            <select name="product" id="product"
              class="w-full flex h-12 border border-gray-200 rounded-md px-3 py-2 text-sm">
              <option value="">ìƒí’ˆì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
              <option value="15900">ìœ ëª… ì‚°ì§€ ì„¤í–¥ ë”¸ê¸° 500g</option>
              <option value="12000">í™í¬ ë”¸ê¸° 500g</option>
            </select>
            <!-- ì„ íƒëœ ìƒí’ˆ ì˜ì—­ -->
            <div id="selectedBox" class="hidden border-t border-gray-100 pt-4 space-y-3">
            </div>
          </div>
        </div>
        <!-- ì´ì•¡ -->
        <div class="flex items-baseline justify-end gap-2 pt-2">
          <span class="text-xs text-gray-500">ì´ ìƒí’ˆê¸ˆì•¡:</span>
          <span id="total" class="total text-3xl font-extrabold text-gray-900">0</span>
          <span class="text-base font-semibold text-gray-900">ì›</span>
        </div>
        <!-- ë²„íŠ¼ ì˜ì—­ -->
        <div class="flex items-center gap-3 pt-2">
          <button id="heart"
            class="w-12 h-12 border border-gray-200 rounded flex items-center justify-center focus:outline-none focus:ring-0 active:outline-none">â™¡</button>
          <button id="bell"
            class="w-12 h-12 border border-gray-200 rounded flex items-center justify-center focus:outline-none focus:ring-0 active:outline-none">ğŸ””</button>
          <button
            class="hover:bg-purple-500 focus:outline-none focus:ring-0 active:outline-none flex-1 h-12 bg-purple-700 text-white rounded font-semibold">
            ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°
          </button>
        </div>
      </div>
    </div>
  </div>
  <script>
    const product = document.getElementById('product');
    const total = document.getElementById('total');
    const selectedBox = document.getElementById('selectedBox');

    const items = {};
    const formatmoney = (m) => m.toLocaleString('ko-KR');
    const render = () => {
      const names = Object.keys(items);
      //ì•„ë¬´ê²ƒë„ ì—†ìœ¼ë©´ ì˜ì—­ì„ ìˆ¨ê¸´ë‹¤
      if (names.length === 0) {
        selectedBox.classList.add('hidden');
        selectedBox.innerHTML = '';
        total.textContent = '0';
        return;
      }
      selectedBox.classList.remove('hidden');
      //ë¦¬ìŠ¤íŠ¸ HTML
      selectedBox.innerHTML = names.map((name) => {
        const { price, qty } = items[name];

        return `
        <div class="flex items-start justify-between gap-4" data-name="${name}">
          <div class="flex-1">
            <p class="text-sm text-gray-700">${name}</p>

            <div class="mt-2 inline-flex items-center border border-gray-200 rounded">
              <button data-action="minus" class="w-8 h-8 flex items-center justify-center text-gray-600">-</button>
              <span class="w-10 text-center font-semibold text-gray-800" data-role="count">${qty}</span>
              <button data-action="plus" class="w-8 h-8 flex items-center justify-center text-gray-600">+</button>
            </div>
          </div>

          <div class="text-right shrink-0">
            <div class="line-through text-gray-300 text-xs">${formatmoney(original)}ì›</div>
            <div class="font-bold text-sm text-gray-800">
              ${formatmoney(price)}ì›
            </div>
          </div>

          <div class="text-right shrink-0">
            <button data-action="remove" class="text-gray-400 text-lg">âœ•</button>
          </div>
        </div>
        `
      }).join('');
      // ì´í•© ê³„ì‚°
      let sum = 0;
      for (const name of names) {
        sum += items[name].price * items[name].qty;
      }
      total.textContent = formatmoney(sum);
    };
    // ì…€ë ‰íŠ¸ ë³€ê²½: ìƒí’ˆ ì¶”ê°€ (ì´ë¯¸ ìˆìœ¼ë©´ ìˆ˜ëŸ‰ +1)
    product.addEventListener('change', () => {
      const original = Number(product.value);
      if (!original) return;

      const price = Math.round(original * 0.8);
      const name = product.options[product.selectedIndex].text;

      if (items[name]) {
        items[name].qty += 1;
      } else {
        items[name] = {
          original,
          price,
          qty: 1
        };
      }

      render();
      product.selectedIndex = 0;
    });

    // + / - / ì‚­ì œ : ì´ë²¤íŠ¸ ìœ„ì„
    selectedBox.addEventListener('click', (e) => {
      const btn = e.target.closest('button');
      if (!btn) return;

      const action = btn.dataset.action;
      const row = btn.closest('[data-name]');
      if (!row) return;

      const name = row.dataset.name;

      if (action === 'plus') {
        items[name].qty += 1;
      }

      if (action === 'minus') {
        items[name].qty = Math.max(1, items[name].qty - 1);
      }

      if (action === 'remove') {
        delete items[name];
      }

      render();
    });

    // ì²˜ìŒ í™”ë©´ ì´ì•¡ 0 ì„¸íŒ…
    render();

  </script>
</body>

</html>